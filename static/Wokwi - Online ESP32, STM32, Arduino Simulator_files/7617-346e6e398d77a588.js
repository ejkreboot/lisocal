(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7617],{4968:(e,t,n)=>{"use strict";n.d(t,{N:()=>r});var a=n(95155);n(12115);function r(e){return(0,a.jsxs)("svg",{viewBox:"0 0 533.5 544.3",width:"1em",height:"1.5em",...e,children:[(0,a.jsx)("path",{d:"M533.5 278.4c0-18.5-1.5-37.1-4.7-55.3H272.1v104.8h147c-6.1 33.8-25.7 63.7-54.4 82.7v68h87.7c51.5-47.4 81.1-117.4 81.1-200.2z",fill:"#4285f4"}),(0,a.jsx)("path",{d:"M272.1 544.3c73.4 0 135.3-24.1 180.4-65.7l-87.7-68c-24.4 16.6-55.9 26-92.6 26-71 0-131.2-47.9-152.8-112.3H28.9v70.1c46.2 91.9 140.3 149.9 243.2 149.9z",fill:"#34a853"}),(0,a.jsx)("path",{d:"M119.3 324.3c-11.4-33.8-11.4-70.4 0-104.2V150H28.9c-38.6 76.9-38.6 167.5 0 244.4l90.4-70.1z",fill:"#fbbc04"}),(0,a.jsx)("path",{d:"M272.1 107.7c38.8-.6 76.3 14 104.4 40.8l77.7-77.7C405 24.6 339.7-.8 272.1 0 169.2 0 75.1 58 28.9 150l90.4 70.1c21.5-64.5 81.8-112.4 152.8-112.4z",fill:"#ea4335"})]})}},5835:(e,t,n)=>{"use strict";n.d(t,{P:()=>p});var a=n(95155),r=n(28492),i=n(14046),s=n(41983),o=n(52619),l=n.n(o),d=n(55030),c=n.n(d),u=n(33483),h=n(40781),m=n(14973);function p(e){let{children:t}=e;const{mode:n,toggleMode:o}=(0,u.e)();return(0,a.jsx)("header",{children:(0,a.jsxs)("div",{className:c().toolbar,role:"banner",children:[(0,a.jsx)(l(),{href:"/",className:c().logo,children:(0,a.jsx)(m.v,{width:80,height:24})}),t,(0,a.jsx)("div",{className:c().spacer}),(0,a.jsx)("nav",{className:c().menu,children:(0,a.jsx)("a",{href:"https://docs.wokwi.com/?utm_source=wokwi",target:"_blank",children:"Docs"})}),(0,a.jsx)(s.A,{onClick:o,color:"inherit","aria-label":"toggle dark mode",size:"small",sx:{marginRight:1},children:"dark"===n?(0,a.jsx)(r.A,{}):(0,a.jsx)(i.A,{})}),(0,a.jsx)(h.B,{size:"small"})]})})}},6744:(e,t,n)=>{"use strict";n.d(t,{A:()=>j});var a=n(95155),r=n(4220),i=n(30285),s=n(10923),o=n(34880),l=n(73741),d=n(25635),c=n(91871),u=n(32683),h=n(12115),m=n(19178),p=n(4968),x=n(9562);function f(e){let{onClose:t}=e;const n=(0,m.A)(),[r,i]=(0,h.useState)(""),[s,l]=(0,h.useState)(0),[u,p]=(0,h.useState)(""),f=async e=>{if(e.preventDefault(),r){l(1);try{await n.signInWithEmail(r),l(3)}catch(e){p("auth/invalid-email"===e.code?'Invalid email address: "'.concat(r,'".'):e.message),l(2)}}};switch(s){case 0:case 2:return(0,a.jsxs)("form",{onSubmit:f,children:[2===s&&(0,a.jsxs)(d.default,{children:[(0,a.jsxs)("p",{children:["Bummer! We had an error and couldn't send you the email:"," ",(0,a.jsx)("span",{style:{color:"red"},children:u})]}),(0,a.jsx)("p",{children:"Let's try once more?"})]}),(0,a.jsxs)(d.default,{sx:{marginTop:4},variant:"body1",color:"textSecondary",align:"center",children:["Enter your email address below",(0,a.jsx)("br",{}),"We'll send you a one-time sign-in link:"]}),(0,a.jsx)(o.default,{display:"flex",alignItems:"center",my:2,children:(0,a.jsx)(x.A,{label:"Email address",fullWidth:!0,autoFocus:!0,onChange:e=>i(e.target.value),value:r})}),(0,a.jsxs)(o.default,{display:"flex",alignItems:"end",justifyContent:"flex-end",children:[(0,a.jsx)(o.default,{children:(0,a.jsx)(c.default,{size:"large",onClick:t,children:"Back"})}),(0,a.jsx)(o.default,{children:(0,a.jsx)(c.default,{size:"large",color:"primary",type:"submit",children:"Continue"})})]})]});case 1:return(0,a.jsx)(d.default,{children:"Sending you an email..."});case 3:return(0,a.jsx)(o.default,{children:(0,a.jsxs)(d.default,{children:["Alright, we sent you an email to ",r,". Please click the sign-in link in that email."]})})}}const g={paper:{marginTop:4,display:"flex",flexDirection:"column",alignItems:"center"},instructions:{marginTop:4},providerList:{marginTop:2}};function j(){const e=(0,m.A)(),[t,n]=(0,h.useState)(!1);return(0,a.jsx)(s.A,{component:"main",maxWidth:"xs",children:(0,a.jsxs)(o.default,{sx:g.paper,children:[(0,a.jsxs)(o.default,{display:"flex",flexDirection:"column",alignItems:"center",mb:2,children:[(0,a.jsx)(l.default,{sx:{width:56,height:56,marginBottom:2,margin:1,backgroundColor:"white"},children:(0,a.jsx)("img",{src:"/images/wokwi-logo.svg",alt:"Wokwi Logo",width:"40",height:"40"})}),(0,a.jsx)(d.default,{component:"h1",variant:"h4",fontWeight:"500",textAlign:"center",children:"Welcome to Wokwi"}),(0,a.jsx)(d.default,{variant:"subtitle1",color:"text.secondary",textAlign:"center",mt:1,children:"In order to continue, please sign in to your account"})]}),t?(0,a.jsx)(f,{onClose:()=>{n(!1)}}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(o.default,{display:"flex",flexDirection:"column",gap:2,width:"100%",mt:2,children:[(0,a.jsx)(c.default,{variant:"outlined",fullWidth:!0,size:"large",startIcon:(0,a.jsx)(p.N,{}),onClick:()=>e.signIn("google"),sx:{color:"white",py:1.5,borderRadius:2,textTransform:"none",fontSize:"1rem",fontWeight:500,boxShadow:"0px 1px 3px rgba(0, 0, 0, 0.08)"},children:"Continue with Google"}),(0,a.jsx)(c.default,{variant:"outlined",fullWidth:!0,size:"large",startIcon:(0,a.jsx)(r.A,{}),onClick:()=>e.signIn("github"),sx:{color:"white",py:1.5,borderRadius:2,textTransform:"none",fontSize:"1rem",fontWeight:500,boxShadow:"0px 1px 3px rgba(0, 0, 0, 0.08)"},children:"Continue with GitHub"}),(0,a.jsx)(c.default,{variant:"outlined",fullWidth:!0,size:"large",startIcon:(0,a.jsx)(i.A,{}),onClick:()=>n(!0),sx:{color:"white",py:1.5,borderRadius:2,textTransform:"none",fontSize:"1rem",fontWeight:500,boxShadow:"0px 1px 3px rgba(0, 0, 0, 0.08)"},children:"Continue with Email"})]}),(0,a.jsxs)(d.default,{variant:"body2",color:"text.secondary",align:"center",mt:4,mb:4,px:2,children:["By continuing, you agree to Wokwi's"," ",(0,a.jsx)(u.default,{href:"/legal/terms",color:"primary",target:"_blank",children:"Terms of Service"})," ","and"," ",(0,a.jsx)(u.default,{href:"/legal/privacy",color:"primary",target:"_blank",children:"Privacy Policy"})]})]})]})})}},8274:e=>{e.exports={debugBar:"debugger-toolbar_debugBar__unQYJ",button:"debugger-toolbar_button__5kN9D",disabled:"debugger-toolbar_disabled__sMvP0",stopButton:"debugger-toolbar_stopButton__E6szZ"}},8591:e=>{e.exports={splitPane:"workbench-desktop_splitPane__nOV1_",container:"workbench-desktop_container__LDB8z",editor:"workbench-desktop_editor__AmDGz",preview:"workbench-desktop_preview__AdZiG",diagramOnly:"workbench-desktop_diagramOnly__6EwWF"}},16104:e=>{e.exports={modalContent:"share-modal_modalContent__a0qu0",shareLinkContainer:"share-modal_shareLinkContainer___kHxS"}},19122:e=>{e.exports={altContent:"user-menu_altContent__kVmnu",alt1:"user-menu_alt1__5Xyya",alt2:"user-menu_alt2___1kYx","show-hide":"user-menu_show-hide__C3b0m"}},19901:(e,t,n)=>{"use strict";n.d(t,{c:()=>i,i:()=>s});var a=n(97035);const r="wokwidbg;v1;";function i(e){return e.length>=512&&(0,a.Lf)(new Uint8Array(e.buffer.slice(0,512)))}function s(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];const s=n+e.length;let o=!1;for(let l=0;l<t.length;l+=512){const d=(0,a.Wq)(t.subarray(l,l+512)),{flashAddress:c,payload:u,flags:h}=d;if(c>=n&&c<s&&(e.set(u,c-n),o=!0),h&a.FV.notMainFlash){const e=String.fromCharCode.apply(null,Array.from(u));e.startsWith(r)&&i.push(e.substring(r.length))}}return o}},21636:e=>{e.exports={main:"project-page_main__KMKhI",button:"project-page_button__5z1or",buttonIcon:"project-page_buttonIcon__tgieg"}},31836:(e,t,n)=>{"use strict";n.d(t,{f:()=>l});var a=n(95155),r=n(48833),i=n(33567),s=n(38688),o=n(6744);function l(e){let{open:t,onClose:n}=e;const l=(0,i.default)();return(0,a.jsx)(r.A,{open:t,onClose:n,sx:{"& .MuiDialog-container":{alignItems:"flex-start"},"& .MuiPaper-root":{background:"#333",border:"solid ".concat(l.palette.primary.main," 4px"),padding:1}},"aria-labelledby":"signup-modal-title","aria-describedby":"signup-modal-description",children:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.J,{onClose:n,sx:{right:l.spacing(1),top:l.spacing(1)}}),(0,a.jsx)(o.A,{})]})})}},32485:(e,t,n)=>{"use strict";function a(e){return{sidesetCount:e>>29&7,sideEn:!!(e&1<<30)}}function r(e){const t=255&e;switch(e>>>13){case 0:{const e={0:"",1:"!x",2:"x--",3:"!y",4:"y--",5:"x!=y",6:"pin",7:"!osre"}[t>>5],n=31&t;return"jmp ".concat(e?e+", ":"").concat(n)}case 1:{const e={0:"gpio",1:"pin",2:"irq",3:"reserved"}[t>>5&3],n="irq"===e?7&t:31&t,a="irq"===e&&16&t?" rel":"";return"wait ".concat(128&t?"1":"0"," ").concat(e," ").concat(n).concat(a)}case 2:{const e=31&t;return"in ".concat({0:"pins",1:"x",2:"y",3:"null",4:"reserved",5:"reserved",6:"isr",7:"osr"}[t>>5],", ").concat(e||32)}case 3:{const e=31&t;return"out ".concat({0:"pins",1:"x",2:"y",3:"null",4:"pindirs",5:"pc",6:"isr",7:"exec"}[t>>5],", ").concat(e||32)}case 4:{const e=32&t?"":" noblock",n=64&t;return 128&t?"pull".concat(n?" ifempty":"").concat(e):"push".concat(n?" iffull":"").concat(e)}case 5:{const e={0:"pins",1:"x",2:"y",3:"null",4:"reserved",5:"status",6:"isr",7:"osr"}[7&t],n=t>>3&3,a={0:"pins",1:"x",2:"y",3:"reserved",4:"exec",5:"pc",6:"isr",7:"osr"}[t>>5&7],r=0===n?"":1===n?"~":2===n?"::":"";return e===a&&0===n?"nop":"mov ".concat(a,", ").concat(r).concat(e)}case 6:{if(128&t)return".data ".concat(e.toString(16));const n=32&t?" wait":"",a=16&t?" rel":"",r=7&t;return"irq".concat(64&t?" clear":"").concat(n," ").concat(r).concat(a)}case 7:{const e=31&t;return"set ".concat({0:"pins",1:"x",2:"y",4:"pindirs"}[t>>5],", ").concat(e)}}return".data ".concat(e.toString(16))}function i(e){let{sidesetCount:t,sideEn:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a(0);const i=[],s=[];for(let a=0;a<e.length;a++){const o=e[a],l=o>>8&31,d=l&(1<<5-t)-1;let c=r(o);if(t&&(!n||16&l)){let e=l>>5-t;n&&(e&=(1<<t-1)-1),c+=" .side(".concat(e,")")}d&&(c+=" [".concat(d,"]")),i[a]={address:a,text:c,label:!1},o>>13||s.push(31&o)}for(const e of s)i[e]&&(i[e].label=!0);return i}n.d(t,{W:()=>a,n:()=>i})},38688:(e,t,n)=>{"use strict";n.d(t,{J:()=>s});var a=n(95155),r=n(77073),i=n(41983);function s(e){let{onClose:t,sx:n}=e;return(0,a.jsx)(i.A,{onClick:t,sx:{top:0,right:0,color:"#9e9e9e",position:"absolute",...null!=n?n:{}},children:(0,a.jsx)(r.A,{})})}},40781:(e,t,n)=>{"use strict";n.d(t,{B:()=>B});var a=n(95155),r=n(91433),i=n(89218),s=n(7045),o=n(2154),l=n(96831),d=n(90426),c=n(4944),u=n(53657),h=n(85729),m=n(41983),p=n(73741),x=n(53756),f=n(72631),g=n(15240),j=n(17681),b=n(86973),v=n(49501),y=n(91871),k=n(48833),w=n(52363),C=n(65036),A=n(41602),_=n(73707),S=n(75912),P=n(29183),I=n(50546),L=n(52619),E=n.n(L),F=n(12115),N=n(19178),W=n(72386),z=n(92670),D=n(19122),R=n.n(D),T=n(31836);const U=(0,P.A)("div")((e=>{let{theme:t}=e;return{background:t.palette.secondary.dark,textAlign:"center",padding:t.spacing(1),fontSize:"80%"}})),M=[{key:"en",name:"English"},...Object.entries(z.c).map((e=>{let[t,n]=e;return{key:t,name:n.name}}))],B=(0,I.PA)((e=>{let{size:t}=e;const n=(0,N.A)(),[P,I]=(0,F.useState)(!1),L=(0,F.useRef)(null),[z,D]=(0,F.useState)(!1),{translate:B}=(0,W.W)("userMenu"),[O,H]=(0,F.useState)(!1),[G,Y]=(0,F.useState)(!1),K=()=>{H(!1)};(0,F.useEffect)((()=>{Y(n.loggedIn),n.loggedIn&&D(!1)}),[n.loggedIn]);const V=n.bestPlan(),J=n.isClassroomAdmin?"CLASSROOM ADMIN":n.hasClassroomPlan?"CLASSROOM ACCOUNT":V===r.nQ.Club?"CLUB MEMBER":V?"".concat(V.name.toUpperCase()," ACCOUNT"):null;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(T.f,{open:z,onClose:()=>D(!1)}),G?(0,a.jsxs)(m.A,{onClick:()=>I(!P),size:t,children:[(0,a.jsx)(p.default,{src:n.profileImage,alt:n.displayName,ref:L,style:"small"===t?{width:30,height:30}:{}}),(0,a.jsxs)(x.A,{anchorEl:L.current,anchorOrigin:{vertical:"bottom",horizontal:"right"},open:P,onClose:()=>I(!1),children:[(0,a.jsxs)(f.default,{children:[(0,a.jsx)(g.A,{children:(0,a.jsx)(p.default,{src:n.profileImage,alt:n.displayName})}),(0,a.jsx)(j.default,{primary:n.displayName,secondary:n.email})]}),null!=J&&(0,a.jsx)(U,{children:J}),(0,a.jsxs)(b.A,{component:E(),href:"/dashboard/projects",children:[(0,a.jsx)(v.A,{children:(0,a.jsx)(i.A,{})}),(0,a.jsx)(j.default,{children:B("myProjects","My projects")})]}),n.isClassroomAdmin&&(0,a.jsxs)(b.A,{component:E(),href:"/classroom/manage",sx:{color:"primary.main"},children:[(0,a.jsx)(v.A,{children:(0,a.jsx)(s.A,{sx:{color:"primary.main"}})}),(0,a.jsx)(j.default,{children:B("classroom","Manage classroom")})]}),n.isProOrgAdmin&&(0,a.jsxs)(b.A,{component:E(),href:"/dashboard/organization",sx:{color:"primary.main"},children:[(0,a.jsx)(v.A,{children:(0,a.jsx)(o.A,{sx:{color:"primary.main"}})}),(0,a.jsx)(j.default,{children:B("organization","Manage organization")})]}),(0,a.jsxs)(b.A,{component:E(),href:"/dashboard/profile",children:[(0,a.jsx)(v.A,{children:(0,a.jsx)(l.A,{})}),(0,a.jsx)(j.default,{children:B("profile","Profile")})]}),(0,a.jsxs)(b.A,{component:E(),href:"/dashboard/ci",children:[(0,a.jsx)(v.A,{children:(0,a.jsx)(d.A,{})}),(0,a.jsx)(j.default,{children:B("ciTokens","CI Tokens")})]}),n.hasSubscriptions?(0,a.jsxs)(b.A,{component:E(),href:"/dashboard/subscriptions?ref=usermenu",children:[(0,a.jsx)(v.A,{children:(0,a.jsx)(c.A,{})}),(0,a.jsx)(j.default,{children:B("yourSubscription","Your Subscriptions")})]}):(0,a.jsxs)(b.A,{component:E(),href:"/pricing?ref=usermenu",children:[(0,a.jsx)(v.A,{children:(0,a.jsx)(c.A,{})}),(0,a.jsx)(j.default,{children:B("upgrade","Upgrade")})]}),(0,a.jsxs)(b.A,{onClick:()=>{H(!0)},children:[(0,a.jsx)(v.A,{children:(0,a.jsx)(u.A,{})}),(0,a.jsx)(j.default,{children:B("language","Language")})]}),(0,a.jsxs)(b.A,{onClick:()=>{n.logout()},children:[(0,a.jsx)(v.A,{children:(0,a.jsx)(h.A,{})}),(0,a.jsx)(j.default,{children:B("logout","Logout")})]})]})]}):(0,a.jsx)(y.default,{variant:"contained",color:"primary",size:t,onClick:()=>D(!0),children:(0,a.jsxs)("span",{className:R().altContent,children:[(0,a.jsx)("span",{className:R().alt1,children:B("signIn","Sign in")}),(0,a.jsx)("span",{className:R().alt2,children:B("signUp","Sign up")})]})}),(0,a.jsxs)(k.A,{open:O,onClose:K,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[(0,a.jsx)(w.A,{id:"alert-dialog-title",children:"Choose your language"}),(0,a.jsx)(C.A,{children:(0,a.jsx)(A.default,{children:M.map((e=>(0,a.jsx)(_.default,{disableGutters:!0,onClick:()=>{n.setLangId(e.key),K()},children:e.name},e.key)))})}),(0,a.jsx)(S.A,{children:(0,a.jsx)(y.default,{onClick:K,autoFocus:!0,children:"close"})})]})]})}))},41534:e=>{e.exports={debugger:"pio-debugger_debugger__2dWGi",current:"pio-debugger_current__Eqs2r",listing:"pio-debugger_listing__H8pXq",lineNumber:"pio-debugger_lineNumber__5b5Ch",breakpoint:"pio-debugger_breakpoint__IFSxP",registers:"pio-debugger_registers__AGbJB",fifo:"pio-debugger_fifo__Zla_w"}},46806:(e,t,n)=>{"use strict";function a(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"0";return function(e,t,n){for(;e.length<t;)e=n+e;return e}(e.toString(),t,n)}n.d(t,{dP:()=>a})},47617:(e,t,n)=>{"use strict";n.d(t,{z:()=>kn});var a=n(95155),r=n(85409),i=n(89440),s=n.n(i),o=n(30836),l=n(80412),d=n(32900),c=n(90039),u=n(14915),h=n(86973),m=n(85483),p=n(34880),x=n(17681),f=n(99944),g=n(22822),j=n(91871),b=n(78470),v=n(41983),y=n(29183),k=n(50546),w=n(67127),C=n.n(w),A=n(52619),_=n.n(A),S=n(20063),P=n(12115),I=n(72386),L=n(36693),E=n(95760),F=n(40954),N=n(64830),W=n(23905),z=n(10399),D=n(30989),R=n(57593),T=n(53756);const U=(0,P.createContext)(null),M=(0,y.A)(j.default)({minWidth:"28px",padding:"4px 0"});function B(e){let{text:t,children:n,variant:r,...i}=e;const[s,o]=(0,P.useState)(!1),l=(0,P.useRef)(null),d=()=>o(!1);return(0,a.jsxs)(U.Provider,{value:{closeMenu:d},children:[(0,a.jsxs)(R.A,{variant:r,ref:l,children:[(0,a.jsx)(j.default,{variant:r,...i,children:t}),(0,a.jsx)(M,{size:"small",onClick:()=>o(!0),variant:r,children:(0,a.jsx)(D.A,{})})]}),(0,a.jsx)(T.A,{open:s,onClose:d,anchorEl:l.current,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:n})]})}function O(e){let{children:t}=e;const n=(0,P.useContext)(U);return(0,a.jsx)("div",{onClick:()=>{null==n||n.closeMenu()},children:t})}var H=n(85660),G=n(5835);const Y=e=>{let{children:t}=e;return(0,a.jsx)(m.default,{direction:"column",minHeight:"100vh",children:t})};var K=n(23867),V=n(25635),J=n(48833),X=n(75912),q=n(65036),Z=n(52363),$=n(9562);var Q=n(11414),ee=n(15526),te=n(52641),ne=n(9839),ae=n(43861),re=n(75656);const ie=(0,k.PA)((e=>{let{privacy:t,onPrivacyChange:n}=e;const r=(0,P.useContext)(E.Rs);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(te.A,{margin:"normal",children:[(0,a.jsx)(ne.A,{id:"privacy-radio-buttons-group",children:"Project privacy:"}),(0,a.jsxs)(ae.A,{"aria-labelledby":"privacy-radio-buttons-group",name:"controlled-radio-buttons-group",value:t,onChange:e=>n(e.target.value),children:[(0,a.jsx)(f.A,{value:"public",control:(0,a.jsx)(re.A,{}),label:(0,a.jsxs)(m.default,{direction:"row",spacing:1,alignItems:"center",children:[(0,a.jsx)(p.default,{minWidth:60,children:"Public"}),(0,a.jsx)(Q.A,{fontSize:"small"})]})}),(0,a.jsx)(f.A,{value:"unlisted",control:(0,a.jsx)(re.A,{}),label:(0,a.jsxs)(m.default,{direction:"row",spacing:1,alignItems:"center",children:[(0,a.jsx)(p.default,{minWidth:60,children:"Unlisted"}),(0,a.jsx)(ee.A,{fontSize:"small"})]})})]})]}),"unlisted"===t&&!r.caps.includes(K.b8.Unlisted)&&(0,a.jsxs)(V.default,{children:["In order to save unlisted projects, ",(0,a.jsx)("br",{}),"please join one of our paid plans.",(0,a.jsx)(j.default,{variant:"outlined",color:"secondary",href:"https://wokwi.com/pricing?ref=unlisted",target:"_blank",onClick:()=>(0,F.G)("club:learnMore:unlistedSave"),sx:{marginTop:1},children:"Learn more"})]})]})})),se=(0,k.PA)((e=>{let{project:t,isOpen:n,onClose:r,onSaveCopyClick:i}=e;const[s,o]=(0,P.useState)(""),l=(0,P.useContext)(E.Rs),[d,c]=(0,P.useState)("public"),u=l.caps.includes(K.b8.Unlisted);(0,P.useEffect)((()=>{n&&o(function(e){const t=e.match(/^(.*) \((\d+)\)$/);if(t){const e=t[1],n=parseInt(t[2],10);return"".concat(e," (").concat(n+1,")")}return e.endsWith(" Copy")?"".concat(e," (2)"):"".concat(e," Copy")}(t.name))}),[n,t.name]);const h=()=>{r()},p=()=>{s&&(t.setUnlisted("unlisted"===d),t.setLocked(!1),i(s),r())};var x;return(0,a.jsx)(J.A,{open:n,onClose:h,children:(0,a.jsxs)("form",{onSubmit:e=>{p(),e.preventDefault()},children:[(0,a.jsx)(Z.A,{children:"Save a Copy"}),(0,a.jsx)(q.A,{children:(0,a.jsxs)(m.default,{children:[t.owner&&t.owner!==l.id&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(V.default,{children:["This project is owned by ",null!==(x=t.ownerUsername)&&void 0!==x?x:"a different user","."]}),(0,a.jsx)(V.default,{gutterBottom:!0,children:"You can save a copy of this project in your account."})]}),(0,a.jsx)($.A,{autoFocus:!0,margin:"dense",id:"name",label:"Project Name",value:s,fullWidth:!0,variant:"outlined",onChange:e=>{o(e.target.value)}}),(0,a.jsx)(ie,{privacy:d,onPrivacyChange:c}),(0,a.jsx)(V.default,{variant:"caption",color:"text.secondary",children:"Don't share sensitive data (such as passwords) in public projects."})]})}),(0,a.jsxs)(X.A,{children:[(0,a.jsx)(j.default,{color:"inherit",onClick:h,children:"Cancel"}),(0,a.jsx)(j.default,{variant:"contained",disabled:0===s.length||"unlisted"===d&&!u,onClick:p,children:"Save Copy"})]})]})})}));var oe=n(95122);const le=(0,k.PA)((e=>{let{project:t,isOpen:n,onClose:r,onSaveClick:i}=e;const[s,o]=(0,P.useState)(t.name),[l,d]=(0,P.useState)("public"),c=()=>{r()},u=()=>{s&&(t.setUnlisted("unlisted"===l),i(s),r())},h=(0,P.useContext)(E.Rs).caps.includes(K.b8.Unlisted);return(0,a.jsx)(J.A,{open:n,onClose:c,children:(0,a.jsxs)("form",{onSubmit:e=>{u(),e.preventDefault()},children:[(0,a.jsx)(Z.A,{children:"Save Your Project"}),(0,a.jsx)(q.A,{children:(0,a.jsxs)(m.default,{children:[(0,a.jsx)($.A,{autoFocus:!0,margin:"dense",id:"name",label:"Project Name",value:s,fullWidth:!0,variant:"outlined",onChange:e=>{o(e.target.value)}}),(0,a.jsx)(ie,{privacy:l,onPrivacyChange:d}),(0,a.jsx)(V.default,{variant:"caption",color:"text.secondary",children:"Don't share sensitive data (such as passwords) in public projects."})]})}),(0,a.jsxs)(X.A,{children:[(0,a.jsx)(j.default,{color:"inherit",onClick:c,children:"Cancel"}),(0,a.jsx)(j.default,{variant:"contained",disabled:0===s.length||"unlisted"===l&&!h,onClick:u,children:"Save"})]})]})})}));var de=n(38688),ce=n(16104),ue=n.n(ce);function he(e){let{link:t}=e;const{translate:n}=(0,I.W)("project.shareDialog"),i=(0,P.useRef)(null);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("input",{type:"text",value:t,ref:i,readOnly:!0,onClick:()=>{var e;return null===(e=i.current)||void 0===e?void 0:e.select()}}),(0,a.jsx)(b.default,{title:n("copyToClipboard","Copy to clipboard"),children:(0,a.jsx)(v.A,{onClick:e=>{var t;null===(t=i.current)||void 0===t||t.select(),document.execCommand("copy"),e.target.focus()},children:(0,a.jsx)(s(),{path:r.ADG,size:1})})})]})}function me(e){let{open:t,onClose:n,project:i,saving:o,onSaveProject:l}=e;const{translate:d}=(0,I.W)("project.shareDialog");var c;return(0,a.jsxs)(J.A,{open:t,onClose:n,classes:{paper:ue().modalContent},children:[(0,a.jsx)(de.J,{onClose:n}),(0,a.jsx)(Z.A,{children:d("title","Share Project")}),(0,a.jsx)(q.A,{children:(null==i?void 0:i.url)?(0,a.jsx)("div",{className:ue().shareLinkContainer,children:(0,a.jsx)(he,{link:null!==(c=i.url)&&void 0!==c?c:""})}):(0,a.jsxs)(V.default,{children:[d("pleaseSave","To share this project, please save it first:"),(0,a.jsx)(p.default,{mt:2,children:(0,a.jsx)(j.default,{variant:"contained",startIcon:o?(0,a.jsx)(s(),{path:r.PJB,size:1,spin:!0}):(0,a.jsx)(s(),{path:r.nhs,size:1}),onClick:l,children:d("saveProject","Save project")})})]})}),(0,a.jsx)(X.A,{children:(0,a.jsx)(j.default,{onClick:n,children:d("closeButton","Close")})})]})}var pe=n(19178),xe=n(1765);var fe=n(80007),ge=n(49501),je=n(41602),be=n(72631),ve=n(86723),ye=n(61796);const ke=(0,k.PA)((e=>{let{show:t,onHide:n,featureName:r}=e;const i=encodeURIComponent("".concat(r));return(0,a.jsxs)(J.A,{open:t,onClose:n,"aria-labelledby":"form-dialog-title",maxWidth:"md",children:[(0,a.jsx)(Z.A,{id:"form-dialog-title",children:"Hmm... Upgrade?"}),(0,a.jsx)(q.A,{children:"File upload is only available for paying users."}),(0,a.jsxs)(X.A,{children:[(0,a.jsx)(j.default,{variant:"outlined",onClick:n,sx:{margin:1},children:"Close"}),(0,a.jsx)(j.default,{variant:"contained",href:"/pricing?ref=".concat(i),target:"_blank",children:"Learn more"})]})]})}));var we=n(96003),Ce=n(4484),Ae=n(48563),_e=n(4474);function Se(e){var t;return(0,a.jsxs)(p.default,{sx:{position:"relative",display:"inline-flex"},children:[(0,a.jsx)(_e.default,{variant:"determinate",...e}),(0,a.jsx)(p.default,{sx:{top:0,left:0,bottom:0,right:0,position:"absolute",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,a.jsx)(V.default,{variant:"caption",component:"div",color:"text.secondary",children:"".concat(Math.round(null!==(t=e.value)&&void 0!==t?t:100),"%")})})]})}const Pe=(0,k.PA)((e=>{let{file:t,onRemove:n}=e;const r=t.name.substring(ve._j.length);return(0,a.jsxs)(be.default,{secondaryAction:(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(v.A,{onClick:()=>n(t),children:(0,a.jsx)(Ce.A,{})})}),children:[(0,a.jsx)(x.default,{primary:r,secondary:"".concat(t.size," bytes"),sx:{marginRight:1}}),t.transferring&&(0,a.jsx)(Se,{value:Math.floor(100*t.progress)}),t.uploadFailed&&(0,a.jsx)(b.default,{title:"Upload failed",children:(0,a.jsx)(Ae.A,{color:"error"})})]})})),Ie=(0,k.PA)((()=>{const e=(0,pe.A)(),t=(0,we.B)(),{translate:n}=(0,I.W)("editor.sdCard"),[r,i]=(0,P.useState)(!1),s=async n=>{if(!e.caps.includes(K.b8.UploadSdCard))return void i(!0);const{files:a}=await(0,ye.Km)(n?{directory:!0}:{multiple:!0});for(const n of a)t.uploadFile(e,n,ve._j)},o=e=>t.removeServerFile(e),{sdCardFiles:l}=t;return(0,a.jsxs)(p.default,{display:"flex",flexDirection:"column",flex:1,height:0,children:[(0,a.jsx)(ke,{show:r,onHide:()=>i(!1),featureName:"sdcard"}),(0,a.jsxs)(p.default,{p:1,children:[(0,a.jsx)(B,{text:n("uploadFiles","Upload files"),variant:"contained",onClick:()=>s(!1),children:(0,a.jsx)(O,{children:(0,a.jsxs)(h.A,{onClick:()=>s(!0),children:[(0,a.jsx)(ge.A,{children:(0,a.jsx)(fe.A,{fontSize:"small"})}),(0,a.jsx)(x.default,{children:n("uploadCompleteFolder","Upload complete folder")})]})})}),(0,a.jsx)(j.default,{variant:"outlined",sx:{marginLeft:1},onClick:()=>{for(const e of Array.from(t.serverFiles))t.removeServerFile(e)},children:n("uploadCompleteFolder","Delete all files")})]}),(0,a.jsxs)(je.default,{sx:{flex:1,bgcolor:"background.paper",overflow:"auto"},children:[!l.length&&(0,a.jsx)(be.default,{children:(0,a.jsx)(x.default,{primary:n("noFilesYet","No files yet. Please upload some files.")})}),l.map((e=>(0,a.jsx)(Pe,{file:e,onRemove:o},e.name)))]})]})}));var Le=n(60087);var Ee=n(24841),Fe=n(58479),Ne=n(2985),We=n(96275);function ze(e){switch(e){case Ne.i.Running:return"start";case Ne.i.Stopped:return"stop";case Ne.i.Paused:return"pause"}}var De=n(49992),Re=n(39644),Te=n(19901),Ue=n(11634),Me=n(43174),Be=n(85237),Oe=n(79510),He=n(75630),Ge=n(86946),Ye=n(67895),Ke=n(88538),Ve=n(48989),Je=n(27358),Xe=n(72453),qe=n(51611),Ze=n(6490),$e=n(63417),Qe=n(34635),et=n(56422),tt=n(81114),nt=n(52005),at=n(46512),rt=n(2886),it=n(69095);const st=e=>fetch(e).then((e=>e.json())),ot=(0,k.PA)((e=>{let{onAddLibrary:t,onUploadLibrary:n}=e;const{data:r,error:i}=(0,at.Ay)("https://libraries.wokwi.workers.dev/list",st),[s,o]=(0,P.useState)(""),[l,d]=(0,P.useState)(-1),c=(0,P.useRef)(null),u=(0,P.useRef)(null),m=(0,P.useRef)(null);if(i)return(0,a.jsx)(p.default,{p:1,children:(0,a.jsx)(V.default,{children:"Error loading library index :-("})});const x=s.trim().toLowerCase();var f;const g=x&&null!==(f=null==r?void 0:r.libraries.filter((e=>e.toLowerCase().includes(x))))&&void 0!==f?f:[],b=e=>{const t=(e=>{const t=g.length-1;switch(e){case"ArrowUp":return Math.max(0,l-1);case"ArrowDown":return Math.min(t,l+1);case"PageUp":return Math.max(0,l-12);case"PageDown":return Math.max(0,l+12);default:return null}})(e.code);var n;null!=t&&(null===(n=u.current)||void 0===n||n.scrollIntoView({index:t,behavior:"auto",done:()=>d(t)}),e.preventDefault())};return(0,a.jsxs)(p.default,{p:2,minWidth:300,children:[(0,a.jsxs)($e.default,{position:"sticky",onFocus:()=>{var e;return null===(e=c.current)||void 0===e?void 0:e.focus()},children:[(0,a.jsx)(Qe.A,{autoFocus:!0,ref:c,value:s,onChange:e=>o(e.target.value),onClick:e=>e.stopPropagation(),sx:{width:"100%"},onKeyDown:e=>{if("Enter"===e.key){const n=l>=0&&g[l];n&&(t(n),e.preventDefault())}else"ArrowDown"!==e.key&&"ArrowUp"!==e.key&&"PageUp"!==e.key&&"PageDown"!=e.key||(b(e),e.preventDefault())},endAdornment:(0,a.jsx)(et.A,{position:"end",children:(0,a.jsx)(qe.A,{})})})," "]}),(0,a.jsxs)(tt.A,{children:[x&&!r&&(0,a.jsxs)(p.default,{py:2,children:[(0,a.jsx)(V.default,{children:"Loading library index..."}),(0,a.jsx)(nt.default,{})]}),g.length>0&&(0,a.jsx)(rt.aY,{style:{height:"400px",maxHeight:"100%"},data:g,ref:u,scrollerRef:e=>{e instanceof HTMLElement&&(e.addEventListener("keydown",b),m.current=()=>e.removeEventListener("keydown",b))},itemContent:(e,n)=>(0,a.jsx)(h.A,{onClick:()=>t(n),className:(0,it.default)(e===l&&"Mui-focusVisible"),children:n},n)}),x&&!g.length&&(0,a.jsx)(V.default,{color:"gray",children:"No libraries found"}),!x&&(0,a.jsx)(V.default,{color:"gray",children:"Type some text to search for libraries"})]}),!x&&(0,a.jsx)(j.default,{startIcon:(0,a.jsx)(Ze.A,{}),onClick:n,children:"Upload a library"})]})})),lt="wokwi:";var dt=n(61563),ct=n(7954),ut=n(89381),ht=n(73741);function mt(e){const t=e.replace(/([A-Z]+)([A-Z][a-z])/g,"$1-$2").replace(/([a-z\d])([A-Z])/g,"$1-$2").replace(/\W+/g,"-").toLowerCase();return"https://www.arduinolibraries.info/libraries/".concat(t)}const pt=(0,k.PA)((e=>{let{library:t,onRemoveLibrary:n}=e;const[r,i]=t.split("@"),s=null==i?void 0:i.startsWith(lt),o=r+".zip",l=null==i?void 0:i.substring(6),d="https://wokwi.com/storage/libs/".concat(l,"/").concat(o);return(0,a.jsxs)(be.default,{secondaryAction:(0,a.jsxs)(a.Fragment,{children:[s&&(0,a.jsx)("a",{href:d,download:!0,children:(0,a.jsx)(v.A,{children:(0,a.jsx)(dt.A,{})})}),!s&&(0,a.jsx)(v.A,{href:mt(r),target:"_blank",children:(0,a.jsx)(ct.A,{})}),(0,a.jsx)(v.A,{onClick:n,children:(0,a.jsx)(Ce.A,{})})]}),children:[(0,a.jsx)(ge.A,{children:(0,a.jsx)(ht.default,{children:(0,a.jsx)(ut.A,{})})}),(0,a.jsx)(x.default,{primary:s?o:r})]})}));var xt=n(31661);const ft=(0,k.PA)((e=>{let{uploadState:t}=e;const{translate:n}=(0,I.W)("project.libManager.uploadDialog"),r=()=>t.abort();return(0,a.jsxs)(J.A,{open:t.uploading,onClose:r,"aria-labelledby":"form-dialog-title",maxWidth:"md",children:[(0,a.jsx)(Z.A,{id:"form-dialog-title",children:n("title","Uploading library...")}),(0,a.jsx)(q.A,{children:(0,a.jsx)(xt.d,{value:100*t.progress})}),(0,a.jsx)(X.A,{children:(0,a.jsx)(j.default,{onClick:r,children:n("cancelButton","Cancel")})})]})}));var gt=n(87922);class jt{async startUpload(e,t){this.uploading=!0,this.abortController=new AbortController;const n=await(0,W.Us)(e,t,{abortSignal:this.abortController.signal,onProgress:e=>this.updateProgress(e.loaded/e.total)}),a=this.abortController.signal.aborted;return this.finishUpload(),a?null:null!=n?n:null}updateProgress(e){this.progress=e}finishUpload(){this.uploading=!1,this.abortController=void 0}abort(){var e;this.uploading=!1,null===(e=this.abortController)||void 0===e||e.abort()}constructor(){(0,gt._)(this,"uploading",!1),(0,gt._)(this,"progress",0),(0,gt._)(this,"abortController",void 0),(0,Fe.l_)(this)}}const bt=(0,k.PA)((()=>{var e;const t=(0,we.B)(),n=(0,pe.A)(),r=(0,P.useRef)(null),[i,s]=(0,P.useState)(!1),[o,l]=(0,P.useState)(!1),[d]=(0,P.useState)(new jt);var c;const u=Array.from((0,Je.h)(null!==(c=null===(e=t.findFile(Xe.mx))||void 0===e?void 0:e.content)&&void 0!==c?c:"")),h=e=>{t.libraryManager.addLibrary(e),s(!1)},m=e=>{t.libraryManager.removeLibrary(e)};return(0,a.jsxs)(p.default,{display:"flex",flexDirection:"column",flex:1,height:0,position:"relative",children:[(0,a.jsx)(ft,{uploadState:d}),(0,a.jsx)(ke,{show:o,onHide:()=>l(!1),featureName:"libman"}),(0,a.jsxs)(p.default,{p:1,children:[(0,a.jsx)(V.default,{variant:"h5",component:"h2",children:"Project Libraries"}),(0,a.jsx)(b.default,{title:"Add a new library",children:(0,a.jsx)(Ye.A,{color:"primary",size:"medium",ref:r,onClick:()=>s(!0),sx:{position:"absolute",top:16,right:16,zIndex:10},children:(0,a.jsx)(Ge.A,{})})}),(0,a.jsx)(Ke.Ay,{open:i,anchorEl:r.current,onClose:()=>s(!1),onClick:()=>s(!1),onKeyDown:e=>{"Enter"===e.key&&(s(!1),e.stopPropagation())},anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},children:(0,a.jsx)(ot,{onAddLibrary:h,onUploadLibrary:async()=>{if(!n.caps.includes(K.b8.UploadLibraries))return void l(!0);const{files:e}=await(0,ye.Km)({directory:!0}),t=Array.from(e).filter(W.$_);if(!t.length)return void alert("Invalid library: no source files (.c, .cpp, .h) found!");const a=await d.startUpload(n,t);a&&(m(a.libraryName),h("".concat(a.libraryName,"@").concat(lt).concat(a.fileId)))}})})]}),(0,a.jsxs)(je.default,{sx:{flex:1,bgcolor:"background.paper",overflow:"auto"},"aria-labelledby":"nested-list-subheader",subheader:(0,a.jsx)(Ve.A,{component:"div",id:"nested-list-subheader",children:"Installed Libraries"}),children:[!u.length&&(0,a.jsx)(be.default,{children:(0,a.jsx)(x.default,{children:"No libraries installed."})}),u.map((e=>(0,a.jsx)(pt,{library:e,onRemoveLibrary:()=>m(e.split("@")[0])},e)))]})]})}));var vt=n(55406),yt=n(80839),kt=n(23941);var wt=n(32485),Ct=n(34454),At=n(46806),_t=n(76764),St=n(41534),Pt=n.n(St);function It(e){const t=[],{items:n}=e;for(let e=0;e<4;e++)e<n.length?t.push((0,Ct.Fd)(n[e])):t.push("        ");return e.empty&&(t[0]="<EMPTY> "),t.join(" ")}const Lt=(0,k.PA)((()=>{const[e,t]=(0,P.useState)(0),[n,r]=(0,P.useState)(0),[,i]=(0,P.useState)(0),s=(0,P.useContext)(_t.O),o=s.tempRunner,l=o.cpu,d=o.pioRunners[e],{instructions:c,machines:u}=l.pio[e],h=u[n],m=h.pc,p=(0,P.useMemo)((()=>(0,wt.n)(c,(0,wt.W)(h.pinCtrl))),[c,h]),x=function(){const[,e]=(0,P.useState)(0);return(0,P.useCallback)((()=>{e((e=>e+1))}),[])}();(0,P.useEffect)((()=>{const e=setInterval((()=>{i(h.cycles)}),100);return()=>clearInterval(e)}),[h]);const f=()=>{l.pio[e].step(),s.forceUpdate(),i(h.cycles)},g=(0,P.useMemo)((()=>{if(!h.enabled)return"STOP";if(!h.waiting)return"RUN";const e=h.waitPolarity?"1":"0";switch(h.waitType){case 1:return"WAIT ".concat(e," PIN ").concat(h.waitIndex);case 2:return"WAIT RXFIFO";case 3:case 5:return"WAIT TXFIFO";case 4:return"WAIT ".concat(e," IRQ ").concat(h.waitIndex);default:return""}}),[h.waitType,h.waitPolarity,h.waitIndex,h.waiting,h.enabled]);return(0,a.jsxs)("div",{className:Pt().debugger,onKeyPress:e=>{"n"===e.key.toLowerCase()&&(f(),e.preventDefault())},children:[(0,a.jsxs)("div",{children:["Wokwi PIO Debugger"," ",(0,a.jsxs)(R.A,{size:"small",children:[(0,a.jsx)(j.default,{onClick:()=>{s.paused?s.resume():s.pause()},children:s.paused?(0,a.jsx)(vt.A,{}):(0,a.jsx)(yt.A,{})}),(0,a.jsx)(j.default,{disabled:!s.running||!s.paused,children:(0,a.jsx)(kt.A,{onClick:f})})]})," ","PIO:"," ",(0,a.jsxs)(R.A,{size:"small",children:[(0,a.jsx)(j.default,{onClick:()=>t(0),variant:0===e?"contained":"outlined",children:"0"}),(0,a.jsx)(j.default,{onClick:()=>t(1),variant:1===e?"contained":"outlined",children:"1"})]}),"Machine:",(0,a.jsxs)(R.A,{size:"small",children:[(0,a.jsx)(j.default,{onClick:()=>r(0),variant:0===n?"contained":"outlined",children:"0"}),(0,a.jsx)(j.default,{onClick:()=>r(1),variant:1===n?"contained":"outlined",children:"1"}),(0,a.jsx)(j.default,{onClick:()=>r(2),variant:2===n?"contained":"outlined",children:"2"}),(0,a.jsx)(j.default,{onClick:()=>r(3),variant:3===n?"contained":"outlined",children:"3"})]})]}),(0,a.jsx)("div",{className:Pt().listing,children:p.map((e=>(0,a.jsxs)("pre",{className:(0,it.default)(e.address===m&&Pt().current),children:[(0,a.jsx)("input",{title:"Breakpoint","aria-label":"Breakpoint",type:"checkbox",checked:!!(d.breakpoints&1<<e.address),className:(0,it.default)(Pt().breakpoint),onChange:()=>{d.breakpoints^=1<<e.address,x()}}),(0,a.jsx)("span",{className:Pt().lineNumber,children:(0,At.dP)(e.address,2," ")}),(0,a.jsx)("span",{children:e.text})]},e.address)))}),(0,a.jsxs)("div",{className:Pt().registers,children:["Registers: X ",(0,Ct.Fd)(h.x)," Y ",(0,Ct.Fd)(h.y)," ISR ",(0,Ct.Fd)(h.inputShiftReg)," [",(0,a.jsx)("span",{children:(0,At.dP)(h.inputShiftCount,2," ")}),"] OSR"," ",(0,Ct.Fd)(h.outputShiftReg)," [",(0,a.jsx)("span",{children:(0,At.dP)(h.outputShiftCount,2," ")}),"] CYCLES ",(0,a.jsx)("span",{children:(0,At.dP)(h.cycles,8," ")})," ",g,(0,a.jsx)("br",{}),"RX: ",(0,a.jsx)("span",{className:Pt().fifo,children:It(h.rxFIFO)}),"TX: ",(0,a.jsx)("span",{className:Pt().fifo,children:It(h.txFIFO)})]})]})}));var Et=n(96166),Ft=n(9693);class Nt{get currentItemIndex(){return this._currentItemIndex}get running(){return this._running}get failed(){return this._failed}get success(){return!this._failed&&!this._running}async sleep(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];await new Promise((n=>{this.sleepDoneCallback=n,this.sleepEvent.schedule(e),t&&this.sim.resume()}))}async serialReadLine(e){if(0===this.serialBuffer.length){const t=new Promise((e=>{this.serialReadDone=e,this.sim.resume()}));await(e?Promise.race([t,e]):t),this.serialReadDone=()=>{}}return this.serialBuffer.shift()}fail(e){this._failed=!0,this._running=!1;const t=this.items[this._currentItemIndex];t.status="error",t.error=e}async step(){const e=this.items[this._currentItemIndex];if(e){switch(e.status="running",e.type){case"wait-serial":{const t=e.timeout?this.sleep(1e6*e.timeout,!1):void 0;let n=await this.serialReadLine(t);for(;(null==n?void 0:n.trim())!==e.text;){if(!n){this.fail("Timed out after ".concat(e.timeout," ms"));break}n=await this.serialReadLine(t)}break}case"press-button":{const t=this.diagram.parts.find((t=>t.id===e.partId));if(!t)return void this.fail("Part ".concat(e.partId," not found"));t.setFloatVar("pressed",1),await this.sleep(1e6*e.duration),t.setFloatVar("pressed",0);break}case"set-control":{const t=this.diagram.parts.find((t=>t.id===e.partId));if(!t)return void this.fail("Part ".concat(e.partId," not found"));t.setFloatVar(e.control,e.value);break}case"delay":await this.sleep(1e6*e.duration)}this.running&&(e.status="success",this._currentItemIndex++,this.step())}else this._running=!1}constructor(e,t,n){(0,gt._)(this,"sim",void 0),(0,gt._)(this,"diagram",void 0),(0,gt._)(this,"items",void 0),(0,gt._)(this,"_currentItemIndex",void 0),(0,gt._)(this,"_running",void 0),(0,gt._)(this,"_failed",void 0),(0,gt._)(this,"sleepEvent",void 0),(0,gt._)(this,"sleepDoneCallback",void 0),(0,gt._)(this,"serialLine",void 0),(0,gt._)(this,"serialBuffer",void 0),(0,gt._)(this,"serialReadDone",void 0),this.sim=e,this.diagram=t,this.items=n,this._currentItemIndex=0,this._running=!0,this._failed=!1,this.sleepDoneCallback=()=>{},this.serialLine="",this.serialBuffer=[],this.serialReadDone=()=>{},(0,Fe.l_)(this);for(const e of n)e.status=void 0,e.error=void 0;this.sleepEvent=this.sim.tempRunner.createEvent((()=>{this.sim.pause(),this.sleepDoneCallback()})),this.sim.serialRx.subscribe((e=>{for(const t of e)10===t?(this.serialBuffer.push(this.serialLine),this.serialLine="",this.serialReadDone()):this.serialLine+=String.fromCharCode(t)})),this.step()}}var Wt=n(3054),zt=n(34097),Dt=n(34188),Rt=n(67891);const Tt=(0,k.PA)((e=>{let{items:t,diagram:n}=e;const[r,i]=(0,P.useState)(!1),s=(0,P.useRef)(null);function o(e){t.push(e),i(!1)}return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(Wt.A,{ref:s,fontSize:"large",onClick:()=>i(!0),sx:{marginX:1,"&:hover":{color:"white"},cursor:"pointer"}}),(0,a.jsxs)(T.A,{anchorEl:s.current,anchorOrigin:{vertical:"bottom",horizontal:"right"},open:r,onClose:()=>i(!1),children:[(0,a.jsxs)(h.A,{onClick:()=>{const e=n.parts.find((e=>"wokwi-pushbutton"===e.type));var t;o({type:"press-button",partId:null!==(t=null==e?void 0:e.id)&&void 0!==t?t:"btn1",duration:100})},children:[(0,a.jsx)(ge.A,{children:(0,a.jsx)(zt.A,{})}),(0,a.jsx)(x.default,{children:"Interaction"})]}),(0,a.jsxs)(h.A,{onClick:()=>o({type:"delay",duration:1e3}),children:[(0,a.jsx)(ge.A,{children:(0,a.jsx)(Dt.A,{})}),(0,a.jsx)(x.default,{children:"Delay"})]}),(0,a.jsxs)(h.A,{onClick:()=>{o({type:"wait-serial",text:"Serial output",timeout:1e3})},children:[(0,a.jsx)(ge.A,{children:(0,a.jsx)(Rt.A,{})}),(0,a.jsx)(x.default,{children:"Serial"})]})]})]})})),Ut=(0,k.PA)((e=>{let{index:t,item:n,onDelete:r}=e;const i="success"===n.status?"green":"error"===n.status?"#800":"#333";return(0,a.jsxs)(m.default,{sx:{width:250,border:"solid white 1px","&:hover .buttons":{opacity:1}},mb:2,position:"relative",children:[(0,a.jsxs)(m.default,{sx:{background:i},p:1,direction:"row",children:[(0,a.jsxs)(V.default,{flex:"1",children:[t,". ",n.type]}),(0,a.jsxs)(m.default,{className:"buttons",direction:"row",sx:{opacity:0,transition:"opacity 0.2s","&:hover":{opacity:1}},children:[(0,a.jsx)(v.A,{size:"small",onClick:()=>{if("delay"===n.type){const e=prompt("Enter delay in milliseconds",n.duration.toString());e&&(n.duration=parseInt(e,10))}if("wait-serial"===n.type){const e=prompt("Enter expected serial text",n.text);e&&(n.text=e)}},children:(0,a.jsx)(u.A,{})}),(0,a.jsx)(v.A,{size:"small",onClick:()=>r(t),children:(0,a.jsx)(Ce.A,{})})]}),"running"===n.status&&(0,a.jsx)(_e.default,{size:24})]}),(0,a.jsxs)(m.default,{flex:1,sx:{minHeight:100},p:1,justifyContent:"center",children:[(0,a.jsx)(V.default,{children:n.text?'"'.concat(n.text,'"'):"delay"===n.type?"".concat(n.duration," ms"):""}),n.error&&(0,a.jsx)(V.default,{color:"error",children:n.error})]})]})})),Mt=Fe.sH.array([{type:"wait-serial",text:"Pushbutton Counter",timeout:1e3},{type:"press-button",partId:"btn1",duration:100},{type:"delay",duration:500},{type:"press-button",partId:"btn1",duration:100},{type:"delay",duration:500},{type:"press-button",partId:"btn1",duration:100},{type:"delay",duration:500},{type:"wait-serial",text:"Button pressed 3 times",timeout:500}]),Bt=(0,k.PA)((()=>{const e=(0,P.useContext)(_t.O),[t,n]=(0,P.useState)(null),r=(0,we.B)(),i=(0,pe.A)();return(0,a.jsxs)(m.default,{maxHeight:"100%",children:[(0,a.jsx)(m.default,{direction:"row",p:1,px:2,children:(0,a.jsx)(j.default,{variant:"contained",onClick:async()=>{await e.start({files:r.files,chips:r.chips,binaryFiles:r.binaryFiles,diagram:r.diagram,sdCardFiles:r.sdCardFiles,projectId:r.id,tempProjectId:r.tempId,userId:i.id,orgId:i.orgId,autoPause:!0}),e.paused&&n(new Nt(e,r.diagram,Mt))},disabled:null==t?void 0:t.running,children:"Run"})}),(0,a.jsxs)(m.default,{direction:"row",padding:2,flexWrap:"wrap",flex:"1",overflow:"auto",alignItems:"center",children:[Mt.map(((e,t)=>(0,a.jsxs)(m.default,{direction:"row",alignItems:"center",children:[(0,a.jsx)(Ut,{index:t+1,item:e,onDelete:e=>{Mt.splice(e-1,1)}},t),t<Mt.length-1&&(0,a.jsx)(Et.A,{fontSize:"medium",sx:{marginX:1}})]},t))),!(null==t?void 0:t.running)&&(0,a.jsx)(Tt,{diagram:r.diagram,items:Mt}),(null==t?void 0:t.success)&&(0,a.jsx)(Ft.default,{sx:{color:"#0f0",fontSize:128,marginLeft:6},onClick:()=>{for(const e of Mt)e.status=void 0,e.error=void 0;n(null)}})]})]})}));var Ot=n(98940),Ht=n(34768),Gt=(n(58874),n(16969)),Yt=n(8274),Kt=n.n(Yt);const Vt=(0,k.PA)((()=>{const e=(0,P.useContext)(_t.O);return e.running&&e.debuggerEnabled?(0,a.jsxs)("div",{className:Kt().debugBar,children:[e.paused?(0,a.jsx)(b.default,{title:"Resume program",children:(0,a.jsx)("i",{className:(0,it.default)(Kt().button,"codicon codicon-debug-continue"),onClick:()=>e.resume()})}):(0,a.jsx)(b.default,{title:"Pause program",children:(0,a.jsx)("i",{className:(0,it.default)(Kt().button,"codicon codicon-debug-pause"),onClick:()=>e.pause()})}),(0,a.jsx)(b.default,{title:"Step over",children:(0,a.jsx)("i",{className:(0,it.default)(Kt().button,!e.paused&&Kt().disabled,"codicon codicon-debug-step-over"),onClick:()=>e.stepOver()})}),(0,a.jsx)(b.default,{title:"Step into",children:(0,a.jsx)("i",{className:(0,it.default)(Kt().button,!e.paused&&Kt().disabled,"codicon codicon-debug-step-into"),onClick:()=>e.stepInto()})}),(0,a.jsx)(b.default,{title:"Step out (run until return)",children:(0,a.jsx)("i",{className:(0,it.default)(Kt().button,!e.paused&&Kt().disabled,"codicon codicon-debug-step-out"),onClick:()=>e.stepOut()})})]}):null}));var Jt=n(8591),Xt=n.n(Jt),qt=n(85347),Zt=n(22133),$t=n(68417),Qt=n(47862),en=n(33483);const tn=(0,k.PA)((e=>{let{diagram:t,readme:n,files:r}=e;var i;const[s,o]=(0,P.useState)(0),{translate:l}=(0,I.W)("simulator.tabs"),{dark:d}=(0,en.e)();var c;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(Qt.tU,{children:[(0,a.jsx)(Qt.oz,{onClick:()=>o(0),active:0===s,children:l("simulation","Simulation")}),(null==n||null===(i=n.content.trim())||void 0===i?void 0:i.length)?(0,a.jsx)(Qt.oz,{onClick:()=>o(1),active:1===s,children:l("description","Description")}):null]}),0===s&&t&&(0,a.jsx)($t.g,{diagram:t,files:r}),1===s&&(0,a.jsx)("section",{className:(0,it.default)("markdown-body",d&&"dark"),children:(0,a.jsx)(qt.oz,{remarkPlugins:[Zt.A],children:null!==(c=null==n?void 0:n.content)&&void 0!==c?c:""})}),(0,a.jsx)("style",{children:"\n        .markdown-body {\n          background: #eee;\n          color: black;\n          overflow: auto; /* Enable scrolling */\n          padding: 1.5em;\n          min-height: 100%;\n        }\n        .markdown-body.dark {\n          background: #111;\n          color: inherit;\n        }\n        .markdown-body.dark a {\n          color: #88f;\n        }\n        .markdown-body.dark pre {\n          background: #333;\n        }\n\n        .markdown-body::-webkit-scrollbar {\n          height: 16px;\n          width: 16px;\n        }\n\n        .markdown-body::-webkit-scrollbar-thumb,\n        .markdown-body::-webkit-scrollbar-track {\n          border: 4px solid transparent;\n          border-radius: 8px;\n          background-clip: padding-box;\n        }\n\n        .markdown-body::-webkit-scrollbar-thumb {\n          min-height: 40px;\n        }\n        .markdown-body.dark::-webkit-scrollbar-thumb {\n          background-color: #3d3a3a;\n        }\n\n        .markdown-body::-webkit-scrollbar-track {\n          margin-bottom: 8px;\n        }\n        .markdown-body.dark::-webkit-scrollbar-track {\n          background-color: #2a2a2a;\n        }\n\n        .markdown-body table th,\n        .markdown-body table td {\n          background: #ddd;\n          padding: 2px 8px;\n        }\n\n\n        .markdown-body.dark table {\n          color: #eee;\n        }\n\n        .markdown-body.dark table th,\n        .markdown-body.dark table td {\n          background: #333;\n        }\n      "})]})})),nn=(0,k.PA)((e=>{let{project:t,files:n}=e;const r=(0,P.useContext)(H.p),{ref:i,width:s=1,height:o=1}=(0,Ot.A)(),[l,d]=(0,P.useState)("");(0,P.useEffect)((()=>{"diagram"===(0,Gt.X)().view&&d("diagram")}),[]),(0,P.useEffect)((()=>{var e;null===(e=r.doLayout)||void 0===e||e.call(r)}),[s,o,r]);const c=t.files.some((e=>["readme","diagram"].includes(e.type))),u=()=>(0,a.jsxs)("div",{className:Xt().editor,ref:i,children:[(0,a.jsx)(Vt,{}),(0,a.jsx)(H.B,{tabs:n,architecture:t.architecture})]}),h=()=>(0,a.jsx)("div",{className:Xt().preview,children:(0,a.jsx)(tn,{diagram:t.diagram,readme:t.readme,files:t.files})});return(0,a.jsx)("div",{className:Xt().container,children:"diagram"===l?(0,a.jsx)("div",{className:Xt().diagramOnly,children:h()}):c?(0,a.jsxs)(Ht.DI,{className:Xt().splitPane,snap:!0,children:[(0,a.jsx)(Ht.DI.Pane,{minSize:120,children:u()}),(0,a.jsx)(Ht.DI.Pane,{minSize:200,children:h()})]}):u()})}));var an=n(57813),rn=n(26466),sn=n(48116),on=n(89419),ln=n.n(on);const dn=(0,sn.default)(an.A)({minHeight:24,background:"#333"}),cn=(0,sn.default)(rn.A)((e=>{let{theme:t}=e;return{textTransform:"none",minHeight:24,paddingTop:t.spacing(1),paddingBottom:t.spacing(1),"&.Mui-selected":{background:t.palette.secondary.dark,color:t.palette.primary.contrastText}}}));function un(e){const{children:t,value:n,index:r,...i}=e;return(0,a.jsx)("div",{className:ln().tab,role:"tabpanel",hidden:n!==r,id:"full-width-tabpanel-".concat(r),"aria-labelledby":"full-width-tab-".concat(r),...i,children:n===r&&t})}const hn=(0,k.PA)((e=>{let{project:t,files:n}=e;const{translate:r}=(0,I.W)("simulator.tabs"),i=(0,P.useContext)(H.p),{ref:s,width:o=1,height:l=1}=(0,Ot.A)(),[d,c]=(0,P.useState)(0);(0,P.useEffect)((()=>{var e;null===(e=i.doLayout)||void 0===e||e.call(i)}),[o,l,i]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(dn,{value:d,onChange:(e,t)=>{c(t)},variant:"fullWidth",indicatorColor:"secondary",children:[(0,a.jsx)(cn,{label:r("simulation","Simulation")}),(0,a.jsx)(cn,{label:r("code","Code")})]}),(0,a.jsxs)("div",{className:ln().container,children:[(0,a.jsx)(un,{value:d,index:0,children:(0,a.jsx)("div",{className:ln().diagram,children:t.diagram&&(0,a.jsx)($t.g,{diagram:t.diagram,files:t.files})})}),(0,a.jsx)(un,{value:d,index:1,children:(0,a.jsx)("div",{className:ln().editor,ref:s,children:(0,a.jsx)(H.B,{tabs:n,architecture:t.architecture})})})]})]})})),mn={name:"Library Manager",content:"",customComponent:(0,a.jsx)(bt,{})},pn={name:"Test Scenario Editor",content:"",customComponent:(0,a.jsx)(Bt,{})},xn=(0,k.PA)((e=>{let{project:t,hex:r}=e;const i=(0,P.useContext)(_t.O),s=(0,P.useContext)(H.p),o=(0,P.useContext)(He.u),[l,d]=(0,P.useState)(s.ready),c=i.running&&i.showPioDebugger,u=(0,pe.A)(),h=(0,xe.b)(),m=function(){const[e,t]=(0,P.useState)("large");return(0,P.useEffect)((()=>{const e=window.matchMedia("(max-width: 640px)"),n=window.matchMedia("(max-width: 1007px)"),a=()=>{e.matches?t("small"):n.matches?t("medium"):t("large")};return"addEventListener"in e?(e.addEventListener("change",a),n.addEventListener("change",a)):(e.addListener(a),n.addListener(a)),a(),()=>{"removeEventListener"in e?(e.removeEventListener("change",a),n.removeEventListener("change",a)):(e.removeListener(a),n.removeListener(a))}}),[]),e}(),p=function(e){var t;const n=(0,P.useMemo)((()=>({name:"SD Card",content:"",customComponent:(0,a.jsx)(Ie,{})})),[]);return n.modified=e.sdCardFiles.some((e=>e.modified)),(null===(t=e.diagram)||void 0===t?void 0:t.parts.find((e=>"wokwi-microsd-card"===e.type)))?[n]:[]}(t);(0,P.useEffect)((()=>{(null==r?void 0:r.cacheKey)&&De.q.put(r.cacheKey,r)})),function(e){const t="Leave page? Changes you made may not be saved.";(0,P.useEffect)((()=>{const n=n=>{if(Le.default.asPath!==n&&e()&&!confirm(t))throw Le.default.events.emit("routeChangeError"),Le.default.replace(Le.default.asPath,Le.default.asPath,{shallow:!0}),"Abort route change. Please ignore this error."},a=n=>{if(e())return n.preventDefault(),n.returnValue=t,t};return window.addEventListener("beforeunload",a),Le.default.events.on("routeChangeStart",n),()=>{window.removeEventListener("beforeunload",a),Le.default.events.off("routeChangeStart",n)}}),[e])}((0,P.useCallback)((()=>t.modified),[t]));const x="_scenarios.json",f=[...t.files.filter((e=>e.name!==x)),...p,..."arduino"===t.projectType?[mn]:[],...t.files.find((e=>e.name===x))?[pn]:[],...c?[{name:"PIO ðŸ›",content:"",customComponent:(0,a.jsx)(Lt,{})}]:[],...i.debuggerFiles],g={userId:u.id,orgId:u.orgId,projectId:t.id,tempProjectId:t.tempId,hp:u.caps.includes(K.b8.FastBuilds)};(0,P.useEffect)((()=>{t&&l&&t.diagram&&i.start({userId:u.id,orgId:u.orgId,projectId:t.id,files:t.files,diagram:t.diagram,preload:!0})}),[t,l,i,u.id,u.orgId]),s.onEditorReady=()=>{d(!0)},s.onRunCode=()=>{t.diagram&&i.start({...g,files:t.files,diagram:t.diagram})};const j=e=>{t.diagram&&i.start({...g,files:t.files,diagram:t.diagram,autoPause:!0,elf:!0,debug:e})};return s.commands.startPaused={name:"Start program paused",callback:j},s.commands.startPaused={name:"Profile program",callback:()=>{t.diagram&&i.start({...g,files:t.files,diagram:t.diagram,elf:!0,profile:!0})}},s.commands.assemblyListing={name:"View Compiled Assembly Code Listing",keybindings:e=>{let{KeyMod:t,KeyCode:n}=e;return[t.CtrlCmd|n.Backquote]},callback:()=>async function(e,t,n){e.removeFile(W.wK);const{hex:a,hexError:r}=await t.build({...n,files:e.files,diagram:e.diagram||Ee.yF.create(),listing:!0});if(r)return console.error(r),void alert("Error connecting to build server: "+r);if(!(null==a?void 0:a.listing))return console.log(null==a?void 0:a.stderr),void alert("Build failed!");const i=e.findFile(W.wK);i?(i.update(a.listing),i.setPristine()):e.addFile(W.wK,a.listing)}(t,i,g)},s.commands.openControlSocket={name:"Open Debug Web Socket",callback:()=>{const e=prompt("Web socket URL?","ws://localhost:2442");e&&function(e,t,n){const a=new WebSocket(e),r=[];let i=!1,s=!1;const o=e=>{a.send(JSON.stringify(e))};a.addEventListener("open",(()=>{o({cmd:"aloha",protocol:"wokwi",version:1}),r.push((0,Fe.lB)(t,"status",(e=>{o({cmd:"statusChange",status:ze(e.newValue)}),e.newValue===Ne.i.Paused&&i&&o({cmd:"gdbResponse",response:t.breakpoint?We.vY:We.WH})}),!1))})),a.addEventListener("error",(()=>{alert("Web socket connection failed!")})),a.addEventListener("close",(()=>{for(const e of r)e();console.log("[Websocket] disconnected")})),a.addEventListener("message",(e=>{const a=e.data;let l;try{l=JSON.parse(a)}catch(e){return void console.error("[Websocket] invalid message:",a)}switch(l.cmd){case"start":{const e=l.hex,{diagram:a}=n;if(!a)return void console.error("[Websocket] can't start simulation: missing diagram");e?t.loadHex(e,a).then((()=>{t.resume()})):t.start({files:n.files,diagram:a});break}case"pause":t.pause();break;case"resume":t.resume();break;case"stop":t.stop();break;case"gdb":{i=!0,t.debugging=!0;const e=t.gdbMessage(l.message);e&&o({cmd:"gdbResponse",response:e})}break;case"serialMonitor":var d,c;s||(r.push(null!==(c=null===(d=t.serialRx)||void 0===d?void 0:d.subscribe((e=>{for(const t of e)o({cmd:"serialData",value:t})})))&&void 0!==c?c:()=>0),s=!0)}}))}(e,i,t)}},s.commands.startGDB={name:"Start Web GDB Session (debug build)",callback:()=>{window.open("https://wokwi.github.io/web-gdb/"),j(!0),window.addEventListener("message",(e=>{const t=e.data;"gdbInit"===t.type&&(console.log("GDB Attached!"),function(e,t){const n=(0,Fe.lB)(e,"status",(n=>{n.newValue!==Ne.i.Paused||e.restarting||t.postMessage({type:"gdb",data:e.breakpoint?We.vY:We.WH})}),!1);e.debugging=!0,t.onmessage=n=>{const a=n.data;switch(a.type){case"break":e.pause();break;case"downloadElf":e.buildResult&&t.postMessage({type:"elf",data:e.buildResult.elf});break;case"downloadSources":var r;(null===(r=e.buildResult)||void 0===r?void 0:r.debugSources)&&t.postMessage({type:"sources",data:(0,Fe.HO)(e.buildResult.debugSources)});break;case"gdb":{const n=e.gdbMessage(a.data);n&&t.postMessage({type:"gdb",data:n})}}},t.onmessageerror=()=>{e.debugging=!1,n()}}(i,t.data))}))}},s.commands.downloadHex={name:"Download Compiled Firmware",callback:async()=>{const{hex:e,hexError:n}=await i.build({...g,files:t.files,diagram:t.diagram||Ee.yF.create()});var a,r;if(n)alert(n);else if(null===(r=t.diagram)||void 0===r||null===(a=r.board)||void 0===a?void 0:a.mcuType.startsWith("esp32")){const n=t.diagram.board.mcuType;var s;(0,Oe.PE)("firmware-".concat(n,".bin"),(0,Me.Gp)(null!==(s=null==e?void 0:e.hex)&&void 0!==s?s:""),"application/octet-stream")}else{if((null==e?void 0:e.hex)&&!(null==e?void 0:e.hex.startsWith(":"))){const t=(0,Me.Gp)(e.hex);if((0,Te.c)(t))return void(0,Oe.PE)("firmware.uf2",t,"application/octet-stream")}var o;(0,Oe.PE)("firmware.hex",null!==(o=null==e?void 0:e.hex)&&void 0!==o?o:"","application/octet-stream")}}},s.commands.flash={name:"Flash firmware to device (beta)",callback:async()=>{var e,n;const a=null===(n=t.diagram)||void 0===n||null===(e=n.board)||void 0===e?void 0:e.mcuType;if(!(null==a?void 0:a.startsWith("esp32")))return void alert("This feature is only available for ESP32 boards");const{hex:r,hexError:s}=await i.build({...g,files:t.files,diagram:t.diagram||Ee.yF.create()});if(s)alert(s);else if(r){const e="".concat(r.cacheKey,"-").concat((new Date).getTime());window.open("https://flasher-esp32.apps.wokwi.com/?mcu=".concat(a,"&build=").concat(e)),window.addEventListener("message",(t=>{const n=t.data,a=n.port;if("loadBinary"===n.type&&n.build===e){var i;const e=(0,Me.Gp)(null!==(i=null==r?void 0:r.hex)&&void 0!==i?i:"");a.postMessage({type:"flash",binaries:[{offset:65536,data:e.buffer}]},{transfer:[e.buffer]})}}))}}},s.commands.downloadUF2={name:"Download UF2 Binary",callback:async()=>{const e=n.e(8903).then(n.bind(n,48903)),{hex:a,hexError:r}=await i.build({...g,files:t.files,diagram:t.diagram||Ee.yF.create()}),{hexToUF2:s}=await e;var o;r?alert(r):(0,Oe.PE)("firmware.uf2",s(null!==(o=null==a?void 0:a.hex)&&void 0!==o?o:""),"application/octet-stream")}},s.commands.downloadELF={name:"Download ELF with Debugging Symbols",callback:async()=>{const{hex:e,hexError:n}=await i.build({...g,files:t.files,diagram:t.diagram||Ee.yF.create(),elf:!0,debug:!0});var a;n?alert(n):(0,Oe.PE)("firmware.elf",(0,Me.Gp)(null!==(a=null==e?void 0:e.elf)&&void 0!==a?a:""),"application/octet-stream")}},s.commands.simulateHex={name:"Load HEX File and Start Simulation...",callback:()=>{alert('This command has been renamed to "Upload Firmware and Start Simulationâ€¦"')}},s.commands.uploadFirmware={name:"Upload Firmware and Start Simulationâ€¦",callback:async()=>{const{files:e}=await(0,ye.Km)({}),n=null==e?void 0:e[0];if(!n)return;const a=n.name.toLowerCase(),r=a.endsWith(".hex"),s=await(r?(0,ye.Gu)(n):(0,ye._N)(n));t.diagram&&i.start({...g,files:t.files,diagram:t.diagram,autoPause:a.includes("-pause."),profile:a.includes("-profile."),sideHex:s})}},s.commands.chipAPITracing={name:"Enable Chip API Tracing",callback:async()=>{(0,Re.Y)()}},s.commands.loadCustomBoard={name:"Load custom board file...",callback:async()=>{const{files:e}=await(0,ye.Km)({directory:!0}),n=[...e],a=n.find((e=>"board.json"===e.name)),r=n.find((e=>"board.svg"===e.name));if(!a)return void alert("Error: missing board.json!");if(!r)return void alert("Error: missing board.svg!");const[i,s]=await Promise.all([(0,ye.Gu)(a),(0,ye.Gu)(r)]);h.loadUserBoard(i,s),t.syncDiagram(),o.fit()}},s.commands.downloadPcap={name:"Download WiFi Packet Capture (PCAP) file",callback:async()=>{const{wifi:e}=i;e&&e.medium.frames.length?e.medium.downloadPcap():alert("No clients connect to the virtual WiFi")}},s.commands.enableGateway={name:"Enable Private Wokwi IoT Gateway",callback:()=>{if(!(0,Ue.$D)(u))return void alert("This feature is only available for paying users: https://wokwi.com/pricing");const e=confirm("Enable local Wokwi IoT Gateway?");(0,Ue.bJ)(e)}},s.commands.enablePrivateBuild={name:"Enable private build server",callback:()=>{const e=prompt("Build server name? (empty to disable)","");e&&"PIAI-df68d5f0"!==e&&"localhexi"!==e?alert("Unknown build server"):(localStorage.removeItem("__buildServer"),localStorage.removeItem("__hexi"),"localhexi"===e?localStorage.setItem("__hexi","http://localhost:4055"):e&&localStorage.setItem("__buildServer",e))}},(0,Be.lD)()&&(s.commands.loadLocalLibraries={name:"Select local Arduino libraries directory",callback:async()=>{const e=await(0,Be.G)();e&&(i.localLibraryDirectory=e)}}),s.commands.downloadPcap={name:"Force Save (for locked projects)",callback:async()=>{var e;null===(e=s.onSaveCode)||void 0===e||e.call(s,!0)}},"small"===m?(0,a.jsx)(hn,{project:t,files:f}):(0,a.jsx)(nn,{project:t,files:f})}));var fn=n(30926);const gn=(0,fn.createServerReference)("604d4f845219c8bee0fa39d818d872c0a6f8f73400",fn.callServer,void 0,fn.findSourceMapURL,"likeProjectAction");var jn=n(99368),bn=n(21636),vn=n.n(bn);const yn=(0,y.A)(h.A)({height:48}),kn=(0,k.PA)((e=>{let{project:t,embedMode:n}=e;const[i,h]=(0,P.useState)(!1),[y,k]=(0,P.useState)(!1),[w,A]=(0,P.useState)(!1),[D,R]=(0,P.useState)(!1),[T,U]=(0,P.useState)(!1),M=(0,L.W)(),[K]=(0,P.useState)({ready:!1,embedMode:n||M.embed,commands:{}}),V=(0,P.useContext)(_t.O),J=(0,P.useContext)(E.Rs),{translate:X}=(0,I.W)("project"),q=(0,S.useRouter)();(0,P.useEffect)((()=>{(0,z.h)()}),[]),(0,P.useEffect)((()=>{J.token&&t.updateFromServer(J)}),[t,J,J.token]);const{hatcheryEgg:Z}=M;(0,P.useEffect)((()=>{Z&&t.loadEgg(Z)}),[t,Z]);const $=async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(t.locked){if(!e)return void alert(X("error.saveFailed","Save failed: project is locked!"));if(!confirm(X("confirm.saveLockedProject","Override locked project?")))return}if(t.name)if(te){h(!0);try{await(0,W.JU)(J,t,!1),t.setPristine()}catch(e){alert("Project saving failed! Your changes have not been saved.")}finally{h(!1)}}else U(!0);else R(!0)},Q=async e=>{h(!0);const n=t.name;try{t.setName(e);const n=await(0,W.JU)(J,t,!0);t.changeId(n.projectId),t.changeOwner(n.owner),t.setPristine(),q.push("/projects/".concat(t.id))}catch(e){alert("Project saving failed! Your changes HAVE NOT been saved.\n\n".concat(e)),t.setName(n)}finally{h(!1)}};K.onSaveCode=$,(0,P.useEffect)((()=>()=>{V.closeProject()}),[t,V]);const ee=t.id?(0,N.a)("https://wokwi.com/share/".concat(t.id),t.updated):null,te=t.owner&&t.owner===J.id,{ownerUsername:ne}=t;return(0,a.jsxs)(Y,{children:[(0,a.jsx)(C(),{children:ee&&(0,a.jsx)("link",{rel:"alternate",type:"application/json+oembed",href:ee,title:"Wokwi oEmbed provider"})}),(0,a.jsx)(G.P,{children:(0,a.jsxs)(m.default,{direction:"row",spacing:1,alignItems:"center",children:[(0,a.jsxs)(B,{size:"small",onClick:()=>$(),disabled:!t.modified||i||t.locked,variant:"contained",text:(0,a.jsx)(p.default,{component:"span",sx:{display:{xs:"none",sm:"initial"}},children:X("header.save","Save")}),startIcon:i?(0,a.jsx)(s(),{path:r.PJB,size:1,spin:!0}):(0,a.jsx)(s(),{path:r.nhs,size:1}),children:[(0,a.jsxs)(O,{children:[(0,a.jsxs)(yn,{onClick:()=>k(!0),disabled:i,sx:{display:{xs:"block",sm:"none"}},children:[(0,a.jsx)("div",{className:vn().buttonIcon,children:(0,a.jsx)(s(),{path:r.YuT,size:1})}),X("header.share","Share")]}),(0,a.jsxs)(yn,{disabled:null==t.id,onClick:()=>U(!0),children:[(0,a.jsx)("div",{className:vn().buttonIcon,children:(0,a.jsx)(o.A,{})}),(0,a.jsx)(x.default,{children:X("menu.saveACopy","Save a copy")})]})]}),te&&(0,a.jsx)(yn,{children:(0,a.jsx)(f.A,{control:(0,a.jsx)(g.A,{name:"lock",checkedIcon:(0,a.jsx)(l.A,{}),icon:(0,a.jsx)(d.A,{}),checked:t.locked,onChange:(e,n)=>{null!=t.id&&((0,jn.T)(t.id,{locked:n}),t.setLocked(n))}}),label:X("menu.lockProject","Lock project")})}),(0,a.jsxs)(yn,{onClick:()=>(0,z.z)(t),children:[(0,a.jsx)("div",{className:vn().buttonIcon,children:(0,a.jsx)(s(),{path:r.XCd,size:1})}),(0,a.jsx)(x.default,{children:X("menu.downloadProjectZip","Download project ZIP")})]})]}),(0,a.jsx)(j.default,{size:"small",className:vn().button,sx:{display:{xs:"none",sm:"flex"}},onClick:()=>k(!0),disabled:i,variant:"contained",startIcon:(0,a.jsx)(s(),{path:r.YuT,size:1}),children:X("header.share","Share")}),t.isDBProject&&(0,a.jsx)(b.default,{title:t.userLiked?X("header.unlikeProjectTooltip","Unlike this project"):X("header.likeProjectTooltip","Like this project"),children:(0,a.jsx)(v.A,{onClick:async()=>{if(!J.loggedIn)return void alert(X("error.signInToLikeProject","Please sign-in to Like this project."));if(!t||!t.id)return;const e=!t.userLiked;t.updateUserLike(e),t.updateHearts((await gn(t.id,e)).hearts),(0,F.H)({action:e?"like":"unlike",category:"project",label:t.name})},color:t.userLiked?"primary":"default",size:"large",children:(0,a.jsx)(c.A,{})})}),(te||ne)&&(0,a.jsxs)(p.default,{mx:1,sx:{position:"relative",lineHeight:1.2,display:{xs:"none",md:"block"}},children:[t.name," ",(0,a.jsx)(v.A,{size:"small",sx:{position:"absolute",top:-4},onClick:()=>A(!0),children:(0,a.jsx)(u.A,{})}),ne&&(0,a.jsxs)("div",{children:["by"," ",(0,a.jsx)(_(),{href:"/makers/[maker]",as:"/makers/".concat(ne),children:ne})]})]})]})}),w&&(0,a.jsx)(oe.U,{project:t,isOpen:w,onClose:()=>A(!1)}),(0,a.jsx)(le,{project:t,isOpen:D,onClose:()=>R(!1),onSaveClick:Q}),(0,a.jsx)(se,{project:t,isOpen:T,onClose:()=>U(!1),onSaveCopyClick:Q}),(0,a.jsx)(me,{open:y,project:t,onClose:()=>k(!1),saving:i,onSaveProject:()=>R(!0)}),(0,a.jsx)("main",{className:vn().main,children:(0,a.jsx)(we.v.Provider,{value:t,children:(0,a.jsx)(H.p.Provider,{value:K,children:(0,a.jsx)(xn,{project:t})})})})]})}))},55030:e=>{e.exports={toolbar:"header-small_toolbar__yvrzx",logo:"header-small_logo__fLyJP",menu:"header-small_menu__hiyiT",spacer:"header-small_spacer___h_xx"}},64830:(e,t,n)=>{"use strict";function a(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Date;return"https://wokwi.com/api/oembed?url=".concat(encodeURIComponent(e),"&t=").concat(t.getTime(),"}")}n.d(t,{a:()=>a})},89419:e=>{e.exports={container:"workbench-mobile_container__gLF2d",tab:"workbench-mobile_tab__VY3Ub",editor:"workbench-mobile_editor__nCRvf",diagram:"workbench-mobile_diagram__4gJe2"}},95122:(e,t,n)=>{"use strict";n.d(t,{U:()=>p});var a=n(95155),r=n(19178),i=n(23905),s=n(91871),o=n(48833),l=n(75912),d=n(65036),c=n(52363),u=n(9562),h=n(50546),m=n(12115);const p=(0,h.PA)((e=>{let{project:t,isOpen:n,onClose:h}=e;const[p,x]=(0,m.useState)(!1),[f,g]=(0,m.useState)(null),j=(0,r.A)(),[b,v]=(0,m.useState)(t.name),y=()=>{h()},k=async()=>{try{g(null),x(!0),t.id&&b&&(await(0,i.oB)(j,t.id,b),t.setName(b)),h()}catch(e){console.error(e),g(e instanceof Error?e.message:"An unknown error occurred")}finally{x(!1)}};return(0,a.jsx)(o.A,{open:n,onClose:y,fullWidth:!0,maxWidth:"xs",children:(0,a.jsxs)("form",{onSubmit:e=>{k(),e.preventDefault()},children:[(0,a.jsx)(c.A,{children:"Rename Project"}),(0,a.jsx)(d.A,{children:(0,a.jsx)(u.A,{autoFocus:!0,margin:"dense",id:"name",label:"Project Name",value:b,fullWidth:!0,variant:"outlined",onChange:e=>{v(e.target.value),g(null)},error:null!=f,helperText:f})}),(0,a.jsxs)(l.A,{children:[(0,a.jsx)(s.default,{color:"inherit",onClick:y,children:"Cancel"}),(0,a.jsx)(s.default,{variant:"contained",disabled:0===b.length,onClick:k,loading:p,children:"Rename"})]})]})})}))},99368:(e,t,n)=>{"use strict";n.d(t,{T:()=>r});var a=n(30926);const r=(0,a.createServerReference)("60675a35511f4dc6be99b4592c188b29c04015919a",a.callServer,void 0,a.findSourceMapURL,"updateProjectAction")}}]);